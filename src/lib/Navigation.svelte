<script lang="ts">
	import { rgbToHex } from '$lib';

	import { onMount } from 'svelte';
	import NavLink from './NavLink.svelte';
	import { navIsOpenState } from './stores/nav';

	let isOpen = false;

	function toggleOpen() {
		navIsOpenState.set(!$navIsOpenState);
	}
	$: hidden = !$navIsOpenState;

	let nav: HTMLElement;
	let color: string = 'white';

	onMount(() => {
		const rgb = getComputedStyle(nav).getPropertyValue('background-color');
		color = rgbToHex(rgb);
	});
</script>

<svelte:head>
	<meta name="theme-color" content={color} />
</svelte:head>

<nav
	bind:this={nav}
	id="navigation"
	class="sticky top-0 z-50 bg-white border-slate-200 px-2 sm:px-4 py-2.5 rounded dark:bg-slate-900"
>
	<div class=" relative container flex flex-wrap items-center justify-between mx-auto">
		<a href="/" class="flex items-center">
			<svg class="w-56" viewBox="0 0 715 110" fill="none" xmlns="http://www.w3.org/2000/svg">
				<g clip-path="url(#clip0_0_1)">
					<path
						d="M17.7646 110H-0.133789C-0.545247 110 -0.750977 109.743 -0.750977 109.229L-0.59668 0.680664C-0.59668 0.269206 -0.339518 0.0634766 0.174805 0.0634766H17.7646C18.279 0.0634766 18.5361 0.269206 18.5361 0.680664L18.3818 43.6523H42.0664V0.680664C42.0664 0.269206 42.2721 0.0634766 42.6836 0.0634766H60.2734C60.7878 0.0634766 61.0449 0.269206 61.0449 0.680664L61.3535 109.229C61.3535 109.743 61.0964 110 60.582 110H42.8379C42.3236 110 42.0664 109.743 42.0664 109.229V62.7852H18.3818V109.229C18.3818 109.743 18.1761 110 17.7646 110ZM75.2341 109.229L94.8298 0.680664C94.9326 0.269206 95.1898 0.0634766 95.6012 0.0634766H118.514C118.926 0.0634766 119.183 0.269206 119.286 0.680664L138.11 109.229C138.161 109.743 137.956 110 137.493 110H119.98C119.466 110 119.183 109.743 119.132 109.229L117.434 97.6562H95.9098L94.2126 109.229C94.1611 109.743 93.904 110 93.4411 110H75.8512C75.4398 110 75.2341 109.743 75.2341 109.229ZM106.171 36.4004L99.0729 80.7607H114.271L107.791 36.4004L106.865 30.5371L106.171 36.4004ZM172.821 110H154.922C154.511 110 154.305 109.743 154.305 109.229L154.459 0.680664C154.459 0.269206 154.716 0.0634766 155.231 0.0634766H172.821C173.335 0.0634766 173.592 0.269206 173.592 0.680664L173.438 43.6523H197.122V0.680664C197.122 0.269206 197.328 0.0634766 197.74 0.0634766H215.329C215.844 0.0634766 216.101 0.269206 216.101 0.680664L216.41 109.229C216.41 109.743 216.152 110 215.638 110H197.894C197.38 110 197.122 109.743 197.122 109.229V62.7852H173.438V109.229C173.438 109.743 173.232 110 172.821 110ZM252.817 110H237.002C236.179 110 235.768 109.64 235.768 108.92L235.613 1.29785C235.613 0.474935 236.025 0.0634766 236.848 0.0634766H251.12L277.814 62.3223L277.042 1.29785C277.042 0.474935 277.505 0.0634766 278.431 0.0634766H294.092C294.709 0.0634766 295.018 0.474935 295.018 1.29785L295.172 109.074C295.172 109.691 294.915 110 294.4 110H280.514L253.126 51.8301L254.283 108.766C254.283 109.589 253.795 110 252.817 110ZM342.072 111.543C336.466 111.543 331.297 110.103 326.565 107.223C321.885 104.342 318.13 100.511 315.301 95.7275C312.524 90.8929 311.135 85.5954 311.135 79.835V72.583C311.135 72.0173 311.393 71.7344 311.907 71.7344H329.651C330.063 71.7344 330.268 72.0173 330.268 72.583V79.835C330.268 83.2809 331.426 86.264 333.74 88.7842C336.054 91.2529 338.832 92.4873 342.072 92.4873C345.364 92.4873 348.167 91.2272 350.481 88.707C352.796 86.1354 353.953 83.1781 353.953 79.835C353.953 75.9775 351.433 72.6087 346.392 69.7285C345.569 69.2142 344.489 68.597 343.152 67.877C341.866 67.1055 340.323 66.2311 338.523 65.2539C336.723 64.2767 334.974 63.3252 333.277 62.3994C331.58 61.4222 329.934 60.4964 328.34 59.6221C322.579 56.2275 318.285 51.9844 315.456 46.8926C312.678 41.7493 311.29 35.9889 311.29 29.6113C311.29 23.748 312.73 18.4505 315.61 13.7188C318.49 9.03841 322.245 5.33529 326.874 2.60938C331.554 -0.167969 336.62 -1.55664 342.072 -1.55664C347.678 -1.55664 352.821 -0.167969 357.502 2.60938C362.182 5.43815 365.911 9.19271 368.688 13.873C371.517 18.5534 372.931 23.7995 372.931 29.6113V42.5723C372.931 42.9837 372.726 43.1895 372.314 43.1895H354.57C354.159 43.1895 353.953 42.9837 353.953 42.5723L353.799 29.6113C353.799 25.9082 352.641 22.8994 350.327 20.585C348.012 18.2705 345.261 17.1133 342.072 17.1133C338.832 17.1133 336.054 18.3477 333.74 20.8164C331.426 23.2852 330.268 26.2168 330.268 29.6113C330.268 33.0573 330.988 35.9375 332.428 38.252C333.92 40.5664 336.62 42.778 340.529 44.8867C340.94 45.0924 341.892 45.6068 343.384 46.4297C344.875 47.2526 346.521 48.1784 348.321 49.207C350.173 50.1842 351.844 51.0843 353.336 51.9072C354.827 52.6787 355.727 53.1416 356.036 53.2959C361.282 56.2275 365.422 59.8278 368.457 64.0967C371.543 68.3656 373.086 73.6117 373.086 79.835C373.086 85.8525 371.697 91.2529 368.92 96.0361C366.091 100.819 362.336 104.6 357.656 107.377C352.976 110.154 347.781 111.543 342.072 111.543ZM424.075 110H406.253C405.79 110 405.559 109.743 405.559 109.229V19.1191H385.038C384.523 19.1191 384.266 18.862 384.266 18.3477L384.42 0.680664C384.42 0.269206 384.626 0.0634766 385.038 0.0634766H445.059C445.625 0.0634766 445.908 0.269206 445.908 0.680664V18.3477C445.908 18.862 445.702 19.1191 445.29 19.1191H424.538L424.692 109.229C424.692 109.743 424.486 110 424.075 110ZM511.632 110H460.56C460.148 110 459.942 109.743 459.942 109.229L460.097 0.680664C460.097 0.269206 460.303 0.0634766 460.714 0.0634766H511.478C511.889 0.0634766 512.095 0.320638 512.095 0.834961V18.502C512.095 18.9134 511.889 19.1191 511.478 19.1191H479.075V43.8066H511.478C511.889 43.8066 512.095 44.0124 512.095 44.4238L512.249 62.3223C512.249 62.7337 512.043 62.9395 511.632 62.9395H479.075V90.5586H511.632C512.043 90.5586 512.249 90.8158 512.249 91.3301V109.383C512.249 109.794 512.043 110 511.632 110ZM551.126 110H533.227C532.816 110 532.61 109.743 532.61 109.229L532.919 0.680664C532.919 0.269206 533.124 0.0634766 533.536 0.0634766H565.475C571.184 0.0634766 576.43 1.45215 581.214 4.22949C585.997 7.00684 589.803 10.7357 592.632 15.416C595.512 20.0964 596.952 25.3939 596.952 31.3086C596.952 35.166 596.36 38.6634 595.177 41.8008C593.995 44.9382 592.606 47.5869 591.011 49.7471C589.469 51.9072 588.054 53.5016 586.768 54.5303C592.477 60.8564 595.332 68.2884 595.332 76.8262L595.486 109.229C595.486 109.743 595.229 110 594.715 110H576.816C576.405 110 576.199 109.846 576.199 109.537V76.8262C576.199 73.0202 574.862 69.7285 572.187 66.9512C569.513 64.1738 566.221 62.7852 562.312 62.7852H551.897L551.743 109.229C551.743 109.743 551.537 110 551.126 110ZM565.475 18.9648H551.897V43.8066H565.475C568.716 43.8066 571.596 42.598 574.116 40.1807C576.688 37.7633 577.973 34.806 577.973 31.3086C577.973 27.9655 576.739 25.0853 574.27 22.668C571.802 20.1992 568.87 18.9648 565.475 18.9648Z"
						class="fill-slate-900 dark:fill-slate-200"
					/>
					<rect x="614" y="-3" width="23" height="113" class="fill-teal-800" />
					<rect x="653" y="-3" width="23" height="113" class="fill-teal-600" />
					<rect x="692" y="-3" width="23" height="113" class="fill-teal-400" />
				</g>
			</svg>
		</a>
		<button
			data-collapse-toggle="navbar-default"
			type="button"
			class="inline-flex items-center p-2 ml-3 text-sm text-slate-500 rounded-lg md:hidden hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-200 dark:text-slate-400 dark:hover:bg-slate-700 dark:focus:ring-slate-600"
			aria-controls="navbar-default"
			aria-expanded="false"
			on:click={toggleOpen}
		>
			<span class="sr-only">Open main menu</span>
			<svg
				class="w-6 h-6"
				aria-hidden={isOpen}
				fill="currentColor"
				viewBox="0 0 20 20"
				xmlns="http://www.w3.org/2000/svg"
				><path
					fill-rule="evenodd"
					d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
					clip-rule="evenodd"
				/></svg
			>
		</button>
		<div
			class="absolute md:static top-12 w-full md:block md:w-auto"
			id="navbar-default"
			class:hidden
		>
			<ul
				class="shadow-md shadow-teal-900 md:shadow-none flex flex-col p-4 mt-4 border border-slate-100 rounded-lg bg-slate-50 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white dark:bg-slate-800 md:dark:bg-slate-900 dark:border-slate-700"
			>
				<li>
					<NavLink href="/">Home</NavLink>
				</li>
				<li>
					<NavLink href="/about">About</NavLink>
				</li>
			</ul>
		</div>
	</div>
</nav>
